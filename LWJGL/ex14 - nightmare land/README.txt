This was a crazy departure into nightmare land where
I tried to combine a massive and ugly state machine
with multithreading. I think this is where I realised
state is the enemy... Took a lot of coffee, sweat and
tears before I found my way to functional programming
from here.